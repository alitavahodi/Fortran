PROGRAM AMALI_95
IMPLICIT NONE
INTEGER :: I, J, K
INTEGER, PARAMETER :: M = 2000
DOUBLE PRECISION :: U(-50:50,-50:50)
DOUBLE PRECISION :: RHO(-50:50,-50:50)
DOUBLE PRECISION :: RHO0 = 10.0, R0 = 2.0, A = 20.0
! -----
WRITE(*,*) "PLEASE WAIT..."
! -----
RHO = 0.0
DO I = -50, 50
DO J = -50, 50
IF(I**2 + J**2 .LT. A*A) THEN
RHO(I,J) = RHO0 * EXP(-SQRT(I*I*1.0 + J*J*1.0)/R0)
END IF
END DO
END DO
! -----
U = 0.0
DO K = 1, M
DO I=-49,49
DO J=-49,49
IF(I**2 + J**2 .EQ. A*A) THEN
U(I,J) = 20.0
ELSE
U(I,J) = (1.0/4.0)*(U(I+1,J)+U(I-1,J)+U(I,J+1)+U(I,J-1)) + ACOS(-1.0)*RHO(I,J)
END IF
END DO
END DO
END DO
! -----
OPEN(666,FILE="POT.TXT")
DO I=-50,50
WRITE(666,"(666F17.10)") (U(I,J), J=-50,50)
END DO
CLOSE(666)
WRITE(*,*) " WELL DONE. "
STOP
END PROGRAM AMALI_95